(this.webpackJsonpposenet=this.webpackJsonpposenet||[]).push([[0],{2:function(e){e.exports=JSON.parse('{"d":{"width":640,"height":360},"b":0.35,"a":0.5,"c":600}')},25:function(e,t,n){e.exports=n(41)},30:function(e,t,n){},37:function(e,t){},38:function(e,t){},39:function(e,t){},41:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),o=n(19),a=n.n(o),c=(n(30),n(4)),u=n.n(c),s=n(9),l=n(3),f=n(12),d=n(20),h=n(2),p=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a();case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"green";e.forEach((function(e){if(e.score>=h.a){var r=e.position,i=r.x,o=r.y;t.beginPath(),t.arc(i,o,4,0,2*Math.PI,!1),t.fillStyle=n,t.fill()}}))},v=n(24),g={HEAD_TILT_RIGHT:{message:"leaning to the right too much",type:"HEAD_TILT_RIGHT"},HEAD_TILT_LEFT:{message:"leaning to the left too much",type:"HEAD_TILT_LEFT"},DEFAULT:{message:"you've moved too far from the starting points ",type:"DEFAULT"}},O=function(e){var t=e.keypoints,n=e.startingPoints,r=(e.minDeviationPercentage,function(e){var t=e.keypoints,n=e.startingPoints,r=e.minPartConfidenceScore,i=void 0===r?.99:r,o=e.minDiff,a=void 0===o?5:o,c=n.filter((function(e){var t=e.part;return["leftEye","rightEye"].includes(t)})),u=t.filter((function(e){var t=e.part;return["leftEye","rightEye"].includes(t)}));if(u.some((function(e){return e.score<i})))return[{message:"confidence score for eyes not met",type:"headTilt"}];var s=c[0].position.x-u[0].position.x;return s>0&&Math.abs(s)>a?[g.HEAD_TILT_RIGHT]:s<0&&Math.abs(s)>a?[g.HEAD_TILT_LEFT]:[]}({keypoints:t,startingPoints:n}));return Object(v.a)(r)},b=n(5),y=n(6);function w(){var e=Object(b.a)(["\n  z-index: 1;\n  height: 100vh;\n  width: 100vw;\n  background: white;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return w=function(){return e},e}function E(){var e=Object(b.a)(['\n  width: 80px;\n  height: 80px;\n  margin-top: 10%;\n\n  &:after {\n    content: " ";\n    display: block;\n    width: 64px;\n    height: 64px;\n    margin: 8px;\n    border-radius: 50%;\n    border: 6px solid black;\n    border-color: black transparent black transparent;\n    animation: '," 1.2s linear infinite;\n  }\n"]);return E=function(){return e},e}function T(){var e=Object(b.a)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return T=function(){return e},e}var j=Object(y.b)(T()),k=y.a.div(E(),j),P=y.a.div(w()),R=function(e){var t=e.videoIsReady,n=e.isModelReady;return t&&n?null:i.a.createElement(P,null,i.a.createElement(k,null),i.a.createElement("p",null,function(e,t){return e||t?e&&!t?"loading pose model":"":"preparing webcam"}(t,n)))};function x(){var e=Object(b.a)(["\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n"]);return x=function(){return e},e}var I=y.a.div(x()),A=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useRef)([]),o=Object(r.useRef)(Object(f.a)({timeOutOfPosition:0},g.DEFAULT)),a=Object(r.useRef)(Object(f.a)({timeOutOfPosition:0},g.HEAD_TILT_LEFT)),c=Object(r.useRef)(Object(f.a)({timeOutOfPosition:0},g.HEAD_TILT_RIGHT)),d=Object(r.useState)([]),v=Object(l.a)(d,2),b=v[0],y=v[1],w=Object(r.useState)([]),E=Object(l.a)(w,2),T=E[0],j=E[1],k=function(e){var t=e.videoRef,n=Object(r.useState)(null),i=Object(l.a)(n,2),o=i[0],a=i[1],c=Object(r.useState)(!1),u=Object(l.a)(c,2),s=u[0],f=u[1];return Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",video:{width:h.d.width,height:h.d.height}}}).then((function(e){t.current.srcObject=e,t.current.onloadedmetadata=function(e){t.current.play(),f(!0)},t.current.width=h.d.width,t.current.height=h.d.height})).catch((function(e){return a(e)}))}),[]),{videoError:o,videoIsReady:s}}({videoRef:e}),P=k.videoIsReady,x=k.videoError,A=function(e){var t=e.videoRef,n=e.videoIsReady,i=Object(r.useState)(null),o=Object(l.a)(i,2),a=o[0],c=o[1];return Object(r.useEffect)((function(){n&&p(c)}),[t,n]),a}({videoRef:e,videoIsReady:P});return Object(r.useEffect)((function(){var r;if(P&&A){var i=t.current.getContext("2d"),l=function(){var t=Object(s.a)(u.a.mark((function t(){var r,s,l,f,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.estimateSinglePose(e.current,{flipHorizontal:!1});case 2:r=t.sent,s=r.keypoints,l=r.score,i.drawImage(e.current,0,0,h.d.width,h.d.height),l>=h.b&&(n.current=s,m(s,i)),b.length>0&&0===T.length&&(0===(f=O({keypoints:n.current,startingPoints:b})).length&&(o.current.timeOutOfPosition=0,a.current.timeOutOfPosition=0,c.current.timeOutOfPosition=0),o.current.timeOutOfPosition===h.c||a.current.timeOutOfPosition===h.c||c.current.timeOutOfPosition===h.c?(d=[o.current,c.current,a.current].filter((function(e){return 600===e.timeOutOfPosition})),j(d)):(f.some((function(e){return e.type===g.DEFAULT.type}))&&o.current.timeOutOfPosition++,f.some((function(e){return e.type===g.HEAD_TILT_LEFT.type}))&&a.current.timeOutOfPosition++,f.some((function(e){return e.type===g.HEAD_TILT_RIGHT.type}))&&c.current.timeOutOfPosition++));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();r=requestAnimationFrame((function e(){l(),r=requestAnimationFrame(e)}))}return function(){cancelAnimationFrame(r)}})),x?(console.log(x),i.a.createElement("div",null,"there was an error loading, make sure your browser supports webcam or that your webcam is turned on")):i.a.createElement(I,null,i.a.createElement(R,{videoIsReady:P,isModelReady:!!A}),i.a.createElement("video",{style:{position:"fixed",zIndex:-1},ref:e,autoPlay:!0}),i.a.createElement("canvas",{width:h.d.width,height:h.d.height,ref:t,id:"c1"}),(P||!!A)&&i.a.createElement("div",{style:{marginTop:"30px"}},i.a.createElement("button",{disabled:b.length>0&&0===T.length,onClick:function(){j([]),y(n.current),o.current.timeOutOfPosition=0,a.current.timeOutOfPosition=0,c.current.timeOutOfPosition=0}},"Set starting points"),i.a.createElement("button",{onClick:function(){y([])}},"Stop posture tracking"),T.length>0&&i.a.createElement("div",null,i.a.createElement("p",null,"uh oh you're out of positions for the reasons below, when you're ready press the set starting points to reset"),T.map((function(e,t){var n=e.message;return i.a.createElement("div",{key:t},i.a.createElement("p",null,n))})))))},L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(A,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/posture-net",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/posture-net","/service-worker.js");L?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):_(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):_(t,e)}))}}()}},[[25,1,2]]]);
//# sourceMappingURL=main.ce4bce51.chunk.js.map